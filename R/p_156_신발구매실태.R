################################################################# ---
##             고등학교 실용통계 : 신발구매 실태조사           ##
##                    개발자: 이광춘                           ##
##                최종수정일: 2022-05-24                       ##
################################################################# ---

# 1. 패키지 -------------
library(tidyverse)
library(readxl)
library(usethis)

source("R/util.R")

# 2. 데이터 전처리 -------------

rawData <- readxl::read_excel("inst/extdata/p_156_신발구매실태.xlsx") %>%
  janitor::clean_names(ascii = FALSE) %>%
  janitor::remove_empty("rows") %>%
  janitor::remove_empty("cols")

# datapasta::dpasta(rawData)


# 3. 데이터 -------------

shoes <- tibble::tribble(
  ~학년, ~성별, ~신발_사이즈, ~구매_장소, ~구매_이유, ~x12시_발길이, ~x18시_발길이, ~적합성,
  "1", "1",   "265",    "2",    "2",     "265",     "265",  "1",
  "1", "1",   "275",    "3",    "3",     "260",     "265",  "0",
  "1", "1",   "260",    "5",    "3",     "260",     "260",  "1",
  "1", "1",   "250",    "4",    "3",     "245",     "250",  "1",
  "1", "1",   "255",    "3",    "4",     "250",     "255",  "1",
  "1", "1",   "250",    "4",    "3",     "250",     "250",  "1",
  "1", "1",   "270",    "5",    "2",     "255",     "260",  "0",
  "1", "1",   "270",    "5",    "4",     "265",     "265",  "0",
  "1", "1",   "265",    "1",    "4",     "265",     "265",  "1",
  "1", "1",   "255",    "1",    "3",     "250",     "255",  "1",
  "1", "2",   "220",    "1",    "1",     "220",     "220",  "1",
  "1", "2",   "230",    "5",    "3",     "225",     "230",  "1",
  "1", "2",   "240",    "4",    "1",     "230",     "235",  "0",
  "1", "2",   "225",    "3",    "4",     "225",     "225",  "1",
  "1", "2",   "235",    "2",    "2",     "235",     "235",  "1",
  "1", "2",   "240",    "4",    "2",     "235",     "240",  "1",
  "1", "2",   "245",    "1",    "3",     "240",     "245",  "1",
  "1", "2",   "250",    "2",    "3",     "250",     "250",  "1",
  "1", "2",   "235",    "3",    "1",     "235",     "235",  "1",
  "1", "2",   "245",    "2",    "3",     "240",     "245",  "1",
  "2", "1",   "265",    "4",    "2",     "265",     "265",  "1",
  "2", "1",   "285",    "3",    "1",     "275",     "285",  "1",
  "2", "1",   "275",    "4",    "4",     "270",     "275",  "1",
  "2", "1",   "270",    "4",    "2",     "270",     "270",  "1",
  "2", "1",   "270",    "5",    "1",     "265",     "270",  "1",
  "2", "1",   "275",    "4",    "4",     "275",     "275",  "1",
  "2", "1",   "265",    "5",    "4",     "255",     "260",  "0",
  "2", "1",   "260",    "5",    "2",     "245",     "250",  "0",
  "2", "1",   "285",    "2",    "4",     "270",     "275",  "0",
  "2", "1",   "275",    "5",    "1",     "270",     "275",  "1",
  "2", "2",   "245",    "2",    "1",     "230",     "235",  "0",
  "2", "2",   "235",    "4",    "2",     "230",     "235",  "1",
  "2", "2",   "240",    "4",    "4",     "230",     "235",  "0",
  "2", "2",   "220",    "2",    "4",     "215",     "215",  "0",
  "2", "2",   "225",    "4",    "4",     "220",     "225",  "1",
  "2", "2",   "230",    "3",    "3",     "225",     "230",  "1",
  "2", "2",   "240",    "2",    "4",     "225",     "230",  "0",
  "2", "2",   "250",    "5",    "2",     "255",     "255",  "0",
  "2", "2",   "240",    "1",    "2",     "230",     "235",  "0",
  "2", "2",   "235",    "1",    "2",     "235",     "235",  "1",
  "3", "1",   "250",    "2",    "4",     "250",     "250",  "1",
  "3", "1",   "265",    "4",    "3",     "260",     "265",  "1",
  "3", "1",   "270",    "3",    "4",     "265",     "265",  "0",
  "3", "1",   "275",    "2",    "2",     "265",     "265",  "0",
  "3", "1",   "265",    "5",    "2",     "265",     "270",  "0",
  "3", "1",   "270",    "3",    "1",     "270",     "275",  "0",
  "3", "1",   "285",    "1",    "2",     "280",     "285",  "1",
  "3", "1",   "275",    "1",    "2",     "270",     "275",  "1",
  "3", "1",   "270",    "5",    "1",     "260",     "260",  "0",
  "3", "1",   "265",    "4",    "3",     "260",     "265",  "1",
  "3", "2",   "245",    "2",    "2",     "235",     "235",  "0",
  "3", "2",   "230",    "4",    "2",     "225",     "230",  "1",
  "3", "2",   "255",    "4",    "1",     "250",     "255",  "1",
  "3", "2",   "240",    "5",    "1",     "230",     "230",  "0",
  "3", "2",   "220",    "2",    "4",     "220",     "220",  "1",
  "3", "2",   "235",    "1",    "1",     "230",     "235",  "1",
  "3", "2",   "230",    "5",    "2",     "230",     "235",  "0",
  "3", "2",   "240",    "5",    "1",     "235",     "240",  "1",
  "3", "2",   "235",    "3",    "1",     "230",     "230",  "0",
  "3", "2",   "235",    "4",    "4",     "230",     "235",  "1"
)

shoes <- shoes %>%
  mutate(across(everything(), as.integer))

# 4. 내보내기 ---------------------

shoes <- clean_varnames(shoes)

write_csv(shoes, "data-raw/shoes.csv")

# 5. 문서화 -----------------------

# sinew::makeOxygen(shoes)

usethis::use_data(shoes, overwrite = TRUE, compress = 'xz')


